<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.example.webtoon.dao.admin.IAdminDao">

    <select id="getAdmin" resultType="com.example.webtoon.dto.AdminVO" >
        select * from admin where adminid=#{param1}
    </select>

    <select id="adGetWebtoon" resultType="com.example.webtoon.dto.WebtoonVO">
        select * from webtoon where wseq=#{wseq}
    </select>

    <select id="adSelectWebtoon" resultType="com.example.webtoon.dto.WebtoonVO" parameterType="com.example.webtoon.dto.WebtoonVO">
        select*from webtoon order by wseq desc limit #{displayRow} offset #{startNum}
    </select>

    <select id="adSelectQna" resultType="com.example.webtoon.dto.QnaVO" parameterType="com.example.webtoon.dto.QnaVO">
        select*from qna order by qseq desc limit #{displayRow} offset #{startNum}
    </select>

    <select id="adSelectNotice" resultType="com.example.webtoon.dto.NoticeVO">
        select*from notice order by nseq desc limit #{displayRow} offset #{startNum}
    </select>

    <select id="getAllcount" resultType="_int">
        select count(*) from webtoon
    </select>

    <select id="getAllcountQna" resultType="_int">
        select count(*) from qna
    </select>

    <select id="adAllCountMember" resultType="_int">
        select count(*) from member
    </select>

    <select id="getAllcountNotice" resultType="_int">
        select count(*) from notice
    </select>

    <delete id="adminWebtoonDelete">
        delete from webtoon where wseq=#{wseq}
    </delete>

    <!--userid 기반 myQnaList 가져오기-->
    <select id="selectQnaByUserId" resultType="com.example.webtoon.dto.QnaVO">
        SELECT *
        FROM qna
        WHERE userid = #{userId}
        ORDER BY qseq DESC
            LIMIT #{paging.startNum}, #{paging.displayRow}
    </select>

    <select id="getCountQnaByUserId" resultType="int">
        SELECT COUNT(*)
        FROM qna
        WHERE userid = #{userId}
    </select>

    <insert id="insertQna">
        INSERT INTO qna (userid, pwd, subject, content, indate)
        VALUES (#{userid}, #{pwd}, #{subject}, #{content}, NOW())
    </insert>

    <select id="checkPassword" parameterType="map" resultType="int">
        SELECT COUNT(*)
        FROM users
        WHERE userid = #{userid} AND pwd = #{pwd}
    </select>

    <update id="updateQna" parameterType="com.example.webtoon.dto.QnaVO">
        UPDATE qna
        SET
            subject = #{subject},
            content = #{content},
            indate = NOW()
        WHERE
            qseq = #{qseq} AND userid = #{userid}
    </update>

    <delete id="deleteQna">
        DELETE FROM qna
        WHERE qseq = #{qseq} AND userid = #{userid}
    </delete>
    <!--userid 기반 myQnaList 끝-->

<!-- WebtoonList================   -->


<!-- Q&AList===================   -->


<!-- NoticeList==================   -->
    <insert id="insertNotice" parameterType="com.example.webtoon.dto.NoticeVO">
        insert into notice(adminid,pwd, subject, content) values(#{adminid},#{pwd},#{subject},#{content})
    </insert>

    <select id="selectNoticeOne" resultType="com.example.webtoon.dto.NoticeVO">
        select * from notice where nseq=#{nseq}
    </select>

    <update id="updateNotice" parameterType="com.example.webtoon.dto.NoticeVO">
        update notice set pwd=#{pwd} , subject=#{subject}, content=#{content} where nseq=#{nseq}
    </update>

    <delete id="adminNoticeDelete">
        delete from notice where nseq=#{nseq}
    </delete>


</mapper>